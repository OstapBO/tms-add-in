<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Merge Fields</title>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <style>
      body {
        font-family: Segoe UI, sans-serif;
        margin: 0;
        padding: 16px;
        background: #f5f6f7;
      }
      h1 {
        font-size: 18px;
        margin-bottom: 12px;
      }
      ul {
        list-style: none;
        padding: 0;
        margin: 0;
        display: grid;
        gap: 6px;
      }
      button {
        width: 100%;
        padding: 10px 12px;
        border: 1px solid #d0d4d9;
        border-radius: 4px;
        background: #fff;
        text-align: left;
        cursor: pointer;
      }
      button:hover {
        border-color: #5b9bd5;
        background: #eef5ff;
      }
      small {
        color: #62686f;
        display: block;
        margin-top: 2px;
      }
    </style>
  </head>
  <body>
    <ul id="variables"></ul>

    <script>
      const variables = [
        'Setagy_BusinessPhone',
        'Setagy_FaxPhone',
        'Setagy_24HourPhone',
        'Setagy_EMail',
        'Cust_CustNumber',
        'Cust_LastName',
        'Cust_FirstName',
        'Cust_MiddleName',
        'Cust_FullName',
        'Cust_FirmName',
        'Cust_DBA',
        'Cust_Addr1',
        'Cust_Addr2',
        'Cust_CityStateZip',
        'Cust_City',
        'Cust_State',
        'Cust_Zip',
        'Cust_County',
        'Cust_EMail',
        'Cust_BillName'
      ];

      Office.onReady(() => {
        const list = document.getElementById('variables');
        variables.forEach((key) => {
          const li = document.createElement('li');
          const button = document.createElement('button');
          button.type = 'button';
          button.innerHTML = `${key}<small>Insert {{${key}}}</small>`;
          button.addEventListener('click', () => insertVariableByKey(key));
          li.appendChild(button);
          list.appendChild(li);
        });
      });

      async function insertVariableByKey(key) {
        try {
          await Word.run(async (context) => {
            const selection = context.document.getSelection();
            const token = `{{${key}}}`;
            selection.insertText(token, Word.InsertLocation.replace);

            const cc = selection.insertContentControl();
            cc.tag = key;
            cc.title = key;
            cc.appearance = 'BoundingBox';

            await context.sync();
          });
        } catch (error) {
          console.error('Insert error:', error);
        }
      }
    </script>
  </body>
</html>
