<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Merge Fields</title>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <style>
      body {
        font-family: Segoe UI, sans-serif;
        margin: 0;
        padding: 16px;
        background: #f5f6f7;
      }
      h1 {
        font-size: 18px;
        margin-bottom: 12px;
      }
      ul {
        list-style: none;
        padding: 0;
        margin: 0;
        display: grid;
        gap: 8px;
      }
      button {
        width: 100%;
        padding: 10px 12px;
        border: 1px solid #d0d4d9;
        border-radius: 4px;
        background: #fff;
        text-align: left;
        cursor: pointer;
      }
      button:hover {
        border-color: #5b9bd5;
        background: #eef5ff;
      }
      small {
        color: #62686f;
        display: block;
        margin-top: 4px;
      }
    </style>
  </head>
  <body>
    <h1>Insert Merge Field</h1>
    <ul id="variables"></ul>

    <script>
      const variables = [
        { id: 'CustomerName', label: 'Customer Name', description: 'Insert {{CustomerName}}' },
        { id: 'PolicyNumber', label: 'Policy Number', description: 'Insert {{PolicyNumber}}' },
        // add more entries as needed
      ];

      Office.onReady(() => {
        const list = document.getElementById('variables');

        variables.forEach(({ id, label, description }) => {
          const li = document.createElement('li');
          const button = document.createElement('button');
          button.type = 'button';
          button.innerHTML = `${label}<small>${description}</small>`;
          button.addEventListener('click', () => insertVariableByKey(id));
          li.appendChild(button);
          list.appendChild(li);
        });
      });

      async function insertVariableByKey(key) {
        try {
          await Word.run(async (context) => {
            const selection = context.document.getSelection();
            const token = `{{${key}}}`;
            selection.insertText(token, Word.InsertLocation.replace);

            const cc = selection.insertContentControl();
            cc.tag = key;
            cc.title = key;
            cc.appearance = 'BoundingBox';

            await context.sync();
          });
        } catch (error) {
          console.error('Insert error:', error);
        }
      }
    </script>
  </body>
</html>
